@using GameStore.Extension;
@using Microsoft.AspNet.Identity;
@using GameStore.Domain.Identity;
@using GameStore.Domain.Model;
@model GameStore.WebUI.Areas.Admin.Models.DTO.ProductDTO

@Html.Partial("_FrontPartial")
<style>
    .zoomIn:hover {
        transform: scale(1.1);
        transition: all ease-in-out .3s;
        border: 1px solid white;
        box-shadow: rgb(72, 0, 255) 0px 1px 2px 3px inset;
        background-color: white;
    }

    .zoomIn {
        transition: .2s;
    }
</style>
<div class="row">
    <div class="col-sm-6" style="text-align: center;">
        <img src="~/images/@Model.Image" class="img-responsive" style="width: 100%; height: 540px;" alt="Image">
    </div>
    <div class="col-sm-6" style="text-align: left; height: auto">
        <div style="height: auto;">
            <h2 style="margin-top: 0px;">
                <span class="label label-info">@Model.ProductName</span>
                <small style="vertical-align: middle;">
                    <span class="label label-danger">@Model.CategoryName</span>
                </small>
            </h2>
            <div class="special_item_price">
                Price:
                <span class="price-old">@Html.FormattedCurrency(Model.Price)</span>
                <span class="price-new">@Html.FormattedCurrency(Model.GetDiscountedPrice())</span>
                <label class="bg-danger">Condition: @Model.Condition</label>
            </div>

            <div>
                <p class="bg-info text-center text-uppercase" style="font-weight: bold; font-size:medium; padding: 1%">Super discount when immediately buying*:</p>
                <p><span class="glyphicon glyphicon-check"></span> 2% discount when paying in cash, card or ATM (-@Html.FormattedCurrency(@Model.GetDiscountedPrice() * 2 / 100))</p>
                <p><span class="glyphicon glyphicon-check"></span> Give out limited edition premium mouse pad</p>
                <p><span class="glyphicon glyphicon-check"></span> Super-speed delivery from 1 to 3 hours within districts of Ho Chi Minh City</p>
                <p><span class="glyphicon glyphicon-check"></span> Price includes invoice</p>
                <p><span class="glyphicon glyphicon-check"></span> Nationwide delivery</p>
            </div>

            <div>
                @using (Html.BeginForm("CreateOrUpdate", "ShoppingCart", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
                {
                    @Html.AntiForgeryToken()
                    @Html.Hidden("returnUrl", Request.RawUrl)
                    <input type="hidden" name='id' value='@Model.ProductId'>
                    <input type='number' name='quantity' value="1" autocomplete="on" style="padding: 1.4rem; width: 15%;">
                    <button type='submit' class='btn btn-primary' style="width: 84%; padding: 1.4rem"><span class="glyphicon glyphicon-shopping-cart"></span> Add to cart</button>
                }
            </div>

            <div style="margin-top: 1rem; text-align: center;">
                <button class='btn btn-danger col-sm-6' style="padding: .5rem; border: 3px solid white;">
                    Installment via CARD
                    <p style="font-size: x-small">VISA, MASTER CARD</p>
                </button>
                <button class='btn btn-danger col-sm-6' style="padding: .5rem; border: 3px solid white;">
                    Installment via HDSAIGON
                    <p style="font-size: x-small">ONLY INDENTITY CARD, WITHIN 30MIN</p>
                </button>
            </div>

            <div style="margin-top: 5rem;">
                <p>Please call to check quantity before coming to the store:</p>
                <button class='btn col-sm-6 btnInfo' style="padding: .5rem; border: 1px solid white;">
                    <span class="glyphicon glyphicon-phone-alt"></span>
                    <p style="font-size: x-small">MUA HÀNG 1900 6098</p>
                </button>
                <button class='btn col-sm-6 btnInfo' style="padding: .5rem; border: 1px solid white;">
                    <span class="glyphicon glyphicon-phone"></span>
                    <p style="font-size: x-small">HOTLINE 0932 600 188</p>
                </button>
            </div>
            <div style="margin-top: 8rem;">
                With average rating

                @if (@Model.Reviews.Count() > 0)
                {
                    float avgRating = 0f;
                    foreach (var review in @Model.Reviews)
                    {
                        avgRating = avgRating + review.Rating;
                    }
                    avgRating = avgRating / @Model.Reviews.Count();
                    <span>@avgRating</span>
                }
                else
                {
                    float avgRating = 0f;
                    <span>@avgRating</span>
                } out of 5, based on @Model.Reviews.Count() reviews.
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="row">
        <h3 class="text-left" style="margin-top: 1%;">Related product:</h3>
        <div class="col-md-12">
            <div class="carousel carousel-showmanymoveone slide" id="carousel-tilenav" data-interval="false">
                <div class="carousel-inner" style="height: 220px;">
                    @{
                        var first = true;
                    }
                    @foreach (var item in Model.Products)
                    {
                        <div class="item @(first? Html.Raw("active"): Html.Raw(""))" style="margin-top: 25px;">
                            <div class="zoomIn col-xs-12 col-sm-12 col-md-2" style="padding: 10px;">
                                <a href="~/Product/Detail/@item.ProductId"><img src="~/images/@item.Image" height="150" width="170" alt="@item.ProductName"></a>
                            </div>
                        </div>
                        first = false;
                    }
                </div>
                <a class="left carousel-control" href="#carousel-tilenav" data-slide="prev"><i class="glyphicon glyphicon-chevron-left text-primary"></i></a>
                <a class="right carousel-control" href="#carousel-tilenav" data-slide="next"><i class="glyphicon glyphicon-chevron-right text-primary"></i></a>
            </div>
        </div>
    </div>
</div>

<div class="row">
    @if (!Request.IsAuthenticated)
    {
        <div class="col-sm-6">

            @using (Html.BeginForm("SaveComment", "Product", FormMethod.Post, new { @class = "form-group", role = "form" }))
            {
                if (Model.Reviews.Count() == 0)
                {
                    <h5>This product has no reviews!</h5>
                }
                @Html.AntiForgeryToken()
                <div class="h3 text-left">Write Reviews about @Model.ProductName*:</div>
                <hr />
                @Html.ValidationSummary("", new { @class = "text-danger" })
                <div class="form-group">
                    <div class="control-label">
                        <label>User @User.Identity.GetUserName()</label>
                    </div>
                    <div class="control-label" style="margin-top: 5px">
                        @Html.TextArea("comment", new { @class = "form-control control-label col-sm-12", @style = "width: 550px; height: 80px; min-width: 150px; max-width: 700px; min-height: 80px; max-height: 120px;", @placeholder = "Write your review" })
                        <input type='hidden' name='idproduct' value='@Model.ProductId'>
                        @Html.ValidationMessage("comment")
                    </div>
                    <div class="control-label" style="margin-top: 10rem; width: 400px;">
                        <p style="font-weight: bold">Your rating for this product: </p>
                        @{
                            <span class="col-sm-2">Bad</span>
                            for (int i = 0; i <= 5; i++)
                            {
                                <span class="col-sm-1 glyphicon glyphicon-star"> @Html.RadioButton("rating", value: i) @i</span>
                            }
                            <span class="col-sm-2">Excellent</span>
                        }
                        @Html.ValidationMessage("rating")
                    </div>
                    <div class="col-sm-12" style="margin-top: 20px; margin-left: -3%">
                        <input type="submit" class="btn btn-success" value="Send review" />
                    </div>
                </div>
            }
        </div>
    }

    <div class="col-sm-6">
        <h5>Store of the goods, thank you!</h5>
        <h3 class="text-info">Policy Of Game Store</h3>
        <hr />
        <div class="col-sm-12" style="border: 1px solid gray; padding: 1%; background-color: #fffdf5; opacity: 0.7">
            <div class="col-sm-1 glyphicon glyphicon-certificate"></div>
            <div class="col-sm-11">
                <span>WARRANTY</span>
                <br />
                <span>12 months warranty</span>
            </div>
        </div>
        <div class="col-sm-12" style="border: 1px solid gray; padding: 1%; background-color: #fffdf5; opacity: 0.7">
            <div class="col-sm-1 glyphicon glyphicon-credit-card"></div>
            <div class="col-sm-11">
                <span>PAYMENT</span>
                <br />
                <span>
                    Cash payment, transfer.
                </span>
                <br />
                <span>
                    Free ATM, Visa, Master card fee payment.
                </span>
            </div>
        </div>
        <div class="col-sm-12" style="border: 1px solid gray; padding: 1%; background-color: #fffdf5; opacity: 0.7">
            <div class="col-sm-1 glyphicon glyphicon-usd"></div>
            <div class="col-sm-11">
                <span>INSTALLMENT</span>
                <br />
                <span>Installment: 10% prepayment + ID card + Household registration / Driver's license</span>
                <br />
                <span>Installment: Use a credit card with 0% interest</span>
            </div>

        </div>
        <div class="col-sm-12 bg-info" style="border: 1px solid gray; padding: 1%; background-color: #fffdf5; opacity: 0.7">
            <div class="col-sm-1 glyphicon glyphicon-list"></div>
            <div class="col-sm-11">
                <span>RED INVOICE</span>
                <br />
                <span>Listed price includes red invoices, financial invoices.</span>
                <br />
                <span>No charge for issuing red invoices and financial invoices.</span>
            </div>

        </div>
    </div>
</div>
<div class="row">
    <h3 class="col-sm-6 text-info">Reviews about @Model.ProductName:</h3>
    @foreach (var review in Model.Reviews)
    {
        <div class="form-group col-sm-12">
            <label class="navbar-header text-primary">@review.User.UserName at <span class="text-danger"> @review.ReviewDate.ToString("dd/MM/yyyy hh:mm:ss tt") </span> (with rating <label class="text-danger bg-danger">@review.Rating</label> out of 5) wrote:</label>
            <label class="form-control navbar-header" style="clear:both">@review.Comments</label>

        </div>
    }
</div>


@{
    <script>
        (function () {
            $('.carousel-showmanymoveone .item').each(function () {
                var itemToClone = $(this);

                for (var i = 1; i < 6; i++) {
                    itemToClone = itemToClone.next();

                    if (!itemToClone.length) {
                        itemToClone = $(this).siblings(':first');
                    }

                    itemToClone.children(':first-child')
                        .clone()
                        .addClass("cloneditem-" + (i))
                        .appendTo($(this));
                }
            });
        }());
    </script>
}

